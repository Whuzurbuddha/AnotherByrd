<Page
    x:Class="AnotherByrd.Views.Pages.DashboardPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:converter="clr-namespace:AnotherBird.Converter"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:fa="http://schemas.fontawesome.io/icons/"
    xmlns:models="clr-namespace:AnotherBird.Models"
    xmlns:converter1="clr-namespace:AnotherByrd.Converter"
    Title="DashboardPage"
    d:DesignHeight="450"
    d:DesignWidth="800"
    ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
    ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    mc:Ignorable="d">
    
    <Page.DataContext>
        <models:GetMailViewModel></models:GetMailViewModel>
    </Page.DataContext>
    <Page.Resources>
        <converter1:ToIconConverter x:Key="IconConverter"></converter1:ToIconConverter>
        <converter:MailSenderConverter x:Key="SenderConverter"></converter:MailSenderConverter>
    </Page.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="50" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        
        <ui:BreadcrumbBar 
            Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2">
            <ui:Button Click="CreateNewAccount">
                <fa:ImageAwesome
                    Height="50"
                    Icon="UserPlus"
                    Width="50" />
            </ui:Button>
            <ui:Button Click="OpenNewMailWindow" ToolTip="Write a new mail">
                <Viewbox Height="50" Width="50">
                    <Rectangle Height="20" Width="22">
                        <Rectangle.Resources>
                            <SolidColorBrush Opacity="0" x:Key="Canvas" />
                            <SolidColorBrush
                                Color="#212121"
                                Opacity="0.1"
                                x:Key="Light-Defaultgrey-10" />
                            <SolidColorBrush
                                Color="#212121"
                                Opacity="1"
                                x:Key="Light-Defaultgrey" />
                        </Rectangle.Resources>
                        <Rectangle.Fill>
                            <DrawingBrush Stretch="None">
                                <DrawingBrush.Drawing>
                                    <DrawingGroup>
                                        <DrawingGroup x:Name="Canvas">
                                            <GeometryDrawing Brush="{DynamicResource Canvas}" Geometry="F1M16,16H0V0H16Z" />
                                            <GeometryDrawing Brush="{DynamicResource Canvas}" Geometry="F1M16,16H0V0H16Z" />
                                            <GeometryDrawing Brush="{DynamicResource Canvas}" Geometry="F1M16,16H0V0H16Z" />
                                        </DrawingGroup>
                                        <DrawingGroup x:Name="Level1">
                                            <GeometryDrawing Brush="{DynamicResource Light-Defaultgrey-10}" Geometry="F1M14.5,3.5v9H8.938a4.62,4.62,0,0,0,.109-.968A4.253,4.253,0,0,0,7.6,8.212,5.053,5.053,0,0,0,4.131,6.973,5.163,5.163,0,0,0,1.5,7.659V3.5Z" />
                                            <GeometryDrawing Brush="{DynamicResource Light-Defaultgrey-10}" Geometry="F1M14.5,3.5,8,8.5l-6.5-5Z" />
                                            <GeometryDrawing Brush="{DynamicResource Light-Defaultgrey}" Geometry="F1M14.5,3H1.5L1,3.5V7.991A4.734,4.734,0,0,1,2,7.4V4.535L5.366,7.113A4.788,4.788,0,0,1,7.6,8.212a4.37,4.37,0,0,1,.627.684h.078L14,4.535V12H9.013a4.234,4.234,0,0,1-.206,1H14.5l.5-.5v-9ZM8,7.869,2.97,4H13.03Z" />
                                            <GeometryDrawing Brush="{DynamicResource Light-Defaultgrey}" Geometry="F1M4.844,13.134H4.819a1.361,1.361,0,0,1-1.377,1.05,1.294,1.294,0,0,1-1.054-.491,2.028,2.028,0,0,1-.4-1.321,2.94,2.94,0,0,1,.55-1.826,1.727,1.727,0,0,1,1.447-.728,1.042,1.042,0,0,1,.611.188.846.846,0,0,1,.346.452h.015q.015-.136.073-.562H5.84q-.229,2.578-.23,2.627,0,.967.5.967a.88.88,0,0,0,.762-.539,2.841,2.841,0,0,0,.3-1.4A2.781,2.781,0,0,0,6.36,9.479a3.1,3.1,0,0,0-2.268-.8,3.03,3.03,0,0,0-2.3.971,3.413,3.413,0,0,0-.913,2.432A3.15,3.15,0,0,0,1.753,14.4a3.187,3.187,0,0,0,2.368.884,4.608,4.608,0,0,0,2.007-.4v.752A5.517,5.517,0,0,1,3.994,16a3.963,3.963,0,0,1-2.9-1.074A3.758,3.758,0,0,1,0,12.113,4.046,4.046,0,0,1,1.162,9.149,4,4,0,0,1,4.131,7.973a4.067,4.067,0,0,1,2.805.986,3.277,3.277,0,0,1,1.111,2.573,2.934,2.934,0,0,1-.6,1.907,1.83,1.83,0,0,1-1.472.745Q4.849,14.184,4.844,13.134Zm-.777-2.622a.989.989,0,0,0-.866.527,2.436,2.436,0,0,0-.33,1.314,1.39,1.39,0,0,0,.222.832.7.7,0,0,0,.594.3.946.946,0,0,0,.849-.554,2.972,2.972,0,0,0,.313-1.467Q4.849,10.512,4.067,10.512Z" />
                                        </DrawingGroup>
                                    </DrawingGroup>
                                </DrawingBrush.Drawing>
                            </DrawingBrush>
                        </Rectangle.Fill>
                    </Rectangle>
                </Viewbox>
            </ui:Button>
            <ui:Button Click="OpenAnswerMailWindow" ToolTip="Answer email">
                <fa:ImageAwesome
                    Height="50"
                    Icon="MailReply"
                    Width="50" />
            </ui:Button>
            
            <ui:Button Click="OpenAddressBook" ToolTip="Address book">
                <fa:ImageAwesome Icon="AddressCardOutline" />
            </ui:Button>
            <ui:Button Click="OpenCalendar" ToolTip="Kalender">
                <fa:ImageAwesome Icon="Calendar" />
            </ui:Button>
        </ui:BreadcrumbBar>
     
        <TreeView
            Grid.Column="0"
            Grid.Row="1"
            ItemsSource="{Binding UserAccounts, UpdateSourceTrigger=PropertyChanged}"
            Margin="5,10,3,0"
            Width="200"
            x:Name="ProviderOverview">
            <TreeView.Resources>
                <Style TargetType="TreeViewItem">
                    <Setter Property="Foreground" Value="Silver" />
                </Style>
            </TreeView.Resources>
            <TreeView.ItemTemplate>
                <HierarchicalDataTemplate>
                    <TreeViewItem
                        Expanded="SetMailSender"
                        Header="{Binding AccountName}"
                        IsExpanded="False"
                        x:Name="ReceivedMailsOverview">
                        <TreeViewItem.Resources>
                            <Style TargetType="fa:FontAwesome">
                                <Setter Property="Width" Value="30" />
                            </Style>
                        </TreeViewItem.Resources>
                        <DockPanel MouseDown="ChooseMailbox">
                            <fa:FontAwesome Icon="Inbox" />
                            <TextBlock Text="  Inbox" />
                        </DockPanel>
                        <DockPanel>
                            <fa:FontAwesome Icon="Trash" />
                            <TextBlock Text="  Trash" />
                        </DockPanel>
                        <DockPanel>
                            <fa:FontAwesome Icon="SendOutline" />
                            <TextBlock Text="  Sent Mail" />
                        </DockPanel>
                    </TreeViewItem>
                </HierarchicalDataTemplate>
            </TreeView.ItemTemplate>
        </TreeView>

        <DockPanel Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="35"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <DataGrid Grid.Row="0" Grid.Column="0" Grid.RowSpan="2" x:Name="ReceivedMailOverview"
                              BorderBrush="Silver"
                              BorderThickness="1"
                              Foreground="Black"
                              FontSize="14"
                              AutoGenerateColumns="False"
                              ItemsSource="{Binding 
                                            Path=SelectedMailBox, 
                                            Mode=TwoWay, 
                                            UpdateSourceTrigger=PropertyChanged}"
                              CanUserResizeRows="False" CanUserResizeColumns="True"
                              VerticalScrollBarVisibility="Hidden">
                        <DataGrid.Resources>
                            <Style TargetType="DataGridRowHeader">
                                <Setter Property="Background" Value="Silver"></Setter>
                            </Style>
                            <Style TargetType="DataGridRow">
                            <Setter Property="Background" Value="#FF231829"></Setter>
                            <Setter Property="Foreground" Value="#FFDCAEAE"></Setter>
                                <Setter Property="FontSize" Value="14"></Setter>
                                <EventSetter Event="Selected" Handler="SetSender"></EventSetter>
                            </Style>
                            <Style TargetType="DataGridColumnHeader">
                                <Setter Property="Padding" Value="5, 15, 0,0 "/>
                                <Setter Property="Background" Value="Silver"/>
                            </Style>
                            <Style TargetType="DataGridCell">
                                <Setter Property="BorderThickness" Value="1,0.5,1,0.5"/>
                                <Setter Property="BorderBrush" Value="Silver"/>
                            </Style>
                        </DataGrid.Resources>
                        <DataGrid.Columns>
                            <DataGridTemplateColumn>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                         <Viewbox Width="20 " Height="20" x:Name="AttachIcon" Visibility="Hidden">
                                             <Rectangle Width="20 " Height="20">
                                                    <Rectangle.Resources>
                                                        <SolidColorBrush x:Key="Canvas" Opacity="0" />
                                                        <SolidColorBrush x:Key="White" Color="White" Opacity="1" />
                                                    </Rectangle.Resources>
                                                    <Rectangle.Fill>
                                                        <DrawingBrush Stretch="None">
                                                            <DrawingBrush.Drawing>
                                                                <DrawingGroup>
                                                                    <DrawingGroup x:Name="canvas">
                                                                        <GeometryDrawing Brush="{DynamicResource Canvas}" Geometry="F1M16,16H0V0H16Z" />
                                                                    </DrawingGroup>
                                                                    <DrawingGroup x:Name="level_1">
                                                                        <GeometryDrawing x:Name="AttachIconColor" Brush="White" Geometry="F1M7.75,15h-.5A3.386,3.386,0,0,1,4,11.5V3.682A2.6,2.6,0,0,1,6.5,1,2.6,2.6,0,0,1,9,3.682v7.167A1.55,1.55,0,0,1,7.5,12.44,1.548,1.548,0,0,1,6,10.872V7H7v3.849a.552.552,0,0,0,.5.591.552.552,0,0,0,.5-.591V3.682A1.6,1.6,0,0,0,6.5,2,1.6,1.6,0,0,0,5,3.682V11.5A2.388,2.388,0,0,0,7.25,14h.5A2.388,2.388,0,0,0,10,11.5V5h1v6.5A3.386,3.386,0,0,1,7.75,15Z">
                                                                        </GeometryDrawing>
                                                                    </DrawingGroup>
                                                                </DrawingGroup>
                                                            </DrawingBrush.Drawing>
                                                        </DrawingBrush>
                                                    </Rectangle.Fill>
                                                </Rectangle>
                                            </Viewbox>
                                        <DataTemplate.Triggers>
                                            <DataTrigger Binding="{Binding HasAttachment}" Value="true">
                                                <Setter TargetName="AttachIcon" Property="Visibility" Value="Visible"></Setter>
                                            </DataTrigger>
                                        </DataTemplate.Triggers>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="Date" 
                                                Binding="{Binding Date}"/>
                            <DataGridTextColumn CanUserResize="True"
                                                Header="Sender" 
                                                Binding="{Binding 
                                                    MessageSender, 
                                                    Mode=TwoWay, 
                                                    UpdateSourceTrigger=PropertyChanged,
                                                    Converter={StaticResource SenderConverter}}" 
                                                    Width="Auto" >                                          
                            </DataGridTextColumn>
                            <DataGridTextColumn CanUserResize="True"
                                                Header="Regarding" 
                                                Binding="{Binding 
                                                    MessageSubject, 
                                                    Mode=TwoWay, 
                                                    UpdateSourceTrigger=PropertyChanged}"
                                                    MinWidth="100"
                                                    MaxWidth="300">
                               
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                <DockPanel Grid.Row="0" Grid.Column="1" Dock="Top"
                           MinWidth="400">
                    <ComboBox
                        Width="200"
                        x:Name="AttachmentList"
                        Background="Wheat"
                        ItemsSource="{Binding SelectedMailAttachmentList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                        <ComboBox.Resources>
                            <Style TargetType="ComboBoxItem">
                                <EventSetter Event="Selected" Handler="SetFile"></EventSetter>
                            </Style>
                        </ComboBox.Resources>
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <fa:ImageAwesome Icon="{Binding Converter={StaticResource IconConverter}}"
                                                     DataContext="{Binding AttachmentFileName}"
                                                     Height="20"
                                                     Width="20"></fa:ImageAwesome>
                                    <TextBlock Text=" | ">  </TextBlock>
                                    <TextBlock Padding="5,0,5,0" Width="100"
                                                Text="{Binding Path=AttachmentFileName,
                                    UpdateSourceTrigger=PropertyChanged}"></TextBlock>
                                    <TextBlock Text=" | ">  </TextBlock>
                                    <fa:ImageAwesome Icon="Download"
                                                     DataContext="{Binding IsLoaded}"
                                                     Height="20"
                                                     Width="20"
                                                     Margin="10,0,0,0"
                                                     Visibility="Hidden"
                                                     x:Name="IsLoadedIcon">
                                    </fa:ImageAwesome>
                                </StackPanel>
                                <DataTemplate.Triggers>
                                    <DataTrigger Binding="{Binding IsLoaded}" Value="true">
                                        <Setter TargetName="IsLoadedIcon" Property="Visibility" Value="Visible"></Setter>
                                    </DataTrigger>
                                </DataTemplate.Triggers>
                            </DataTemplate> 
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                    <Label Background="Silver"
                           HorizontalAlignment="Stretch"
                           IsHitTestVisible="False">
                        <TextBlock Text="{Binding 
                                        SelectedMailSender, 
                                        UpdateSourceTrigger=PropertyChanged}"
                                   Foreground="Black"
                                   FontSize="16"></TextBlock>
                    </Label>
                </DockPanel>
                <DockPanel Grid.Row="1" Grid.Column="1">
                    <RichTextBox VerticalScrollBarVisibility="Hidden"
                                 Padding="30"
                                 MinWidth="400"
                                 FlowDirection="LeftToRight"
                                 IsReadOnly="True">
                        <FlowDocument>
                            <Paragraph>
                                <Run Text="{Binding SelectedMailText}"></Run>
                            </Paragraph>
                        </FlowDocument>
                    </RichTextBox>
                </DockPanel>
            </Grid>
        </DockPanel>
    </Grid>
</Page>
